<?xml version="1.0" encoding="utf-8"?>
<configuration>

  <!--
  <appSettings>
    <add key="manual-test-broker-hostname" value="localhost"/>
    <add key="manual-test-broker-port" value="5672"/>
    <add key="manual-test-broker-protocol" value="AMQP_0_9_1"/>
  </appSettings>
  -->
  
  <system.diagnostics>
    <sources>
      <source name="System.ServiceModel.MessageLogging" switchValue="Verbose">
        <listeners>
          <add name="xml" type="System.Diagnostics.XmlWriterTraceListener"
          initializeData="message.log" />
        </listeners>
      </source>
    </sources>
    <trace autoflush="true"/>
  </system.diagnostics>


  <system.serviceModel>
      
    <!--
    <extensions>
      <bindingExtensions>
        <add 
          name="rabbitMQBinding" 
          type="RabbitMQ.ServiceModel.RabbitMQBindingSection, RabbitMQ.ServiceModel, Version=1.0.110.0, Culture=neutral, PublicKeyToken=null"/>
      </bindingExtensions>
    </extensions>
    -->
    

    <services>
      <service name="Sean.World.RestApi.WorldServiceImpl" 
        behaviorConfiguration="WebServiceBehavior">
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8888/WorldService" />
          </baseAddresses>
        </host>
        <endpoint 
          address="" 
          behaviorConfiguration="webEndpointBehavior"
          binding="webHttpBinding" 
          contract="Sean.World.RestApi.IWorldService">
        </endpoint>
      </service>
      
      <!--
      <service name="Sean.World.RestApi.WorldServiceImpl" 
        behaviorConfiguration="metadataSupport"> 
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8888/WorldService/"/>
          </baseAddresses>
        </host>
        <endpoint 
          address="World"
          bindingConfiguration="webHttpBindingWithJSON"
          behaviorConfiguration="webEndpointBehavior"
          binding="basicHttpBinding"
          contract="Sean.World.RestApi.IWorldService"/>
      </service>  
      -->
      <!--
      <service name="Sean.World.RabbitMqService"
        behaviorConfiguration="rabbitBehavior">
        <host>
          <baseAddresses>
            <add baseAddress = "soap.amqp:///" />
          </baseAddresses>
        </host>
        <endpoint
          address="Rabbit"
          binding="rabbitMQBinding"
          bindingConfiguration="rabbitMQConfig"
          contract="Sean.World.IRabbitMqService"/>
      </service>    -->
    </services>
    
    <client>
        <endpoint name="HttpWorldEndpoint"
          address="http://localhost:8888/WorldService" 
          binding="webHttpBinding"
          contract="Sean.World.RestApi.IWorldService"/>
       <!-- bindingConfiguration="bindingSettings" -->
      <!--
      <endpoint name="ServiceOverRabbit"
        address="soap.amqp:///ConfigTest" 
        binding="rabbitMQBinding" 
        bindingConfiguration="rabbitMQConfig" 
        contract="Sean.World.IRabbitMqService"/>
        -->
    </client>
    
    <bindings>
      <webHttpBinding>
        <binding name="webHttpBindingWithJSON" />
      </webHttpBinding>

      <basicHttpBinding>
        <binding name="bindingSettings" 
          messageEncoding="Mtom"/>         
      </basicHttpBinding>

      <!--  
      <rabbitMQBinding>
        <binding name="rabbitMQConfig" 
          hostname="localhost"
          port="5672"
          username="guest"
          password="guest"
          virtualHost="/"
          oneWay="true"
          maxmessagesize="8192" />
      </rabbitMQBinding>
      -->
    </bindings>
    
    <behaviors>
      <endpointBehaviors>
        <behavior name="webEndpointBehavior">
          <webHttp />
        </behavior>
      </endpointBehaviors>

      <serviceBehaviors>
        <behavior name="WebServiceBehavior">
          <serviceMetadata httpGetEnabled="true" />
        </behavior>
        
        <behavior name="metadataSupport">
          <!-- Enables the IMetadataExchange endpoint in services that -->
          <!-- use "metadataSupport" in their behaviorConfiguration attribute. -->
          <!-- In addition, the httpGetEnabled and httpGetUrl attributes publish -->
          <!-- Service metadata for retrieval by HTTP/GET at the address -->
          <!-- "http://localhost:8080/ServiceMetadata?wsdl" -->
          <serviceMetadata httpGetEnabled="true" /> <!--ttpGetUrl=""/>-->
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>

        <behavior name="rabbitBehavior">
        </behavior>
        
      </serviceBehaviors>
    </behaviors>
    
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
    <diagnostics>
      <messageLogging logEntireMessage="true"
        maxMessagesToLog="300"
        logMessagesAtServiceLevel="false"
        logMalformedMessages="true"
        logMessagesAtTransportLevel="true"/>
    </diagnostics>
    
  </system.serviceModel>
</configuration>
